function __processArg(e,t){var o=null;return e&&(o=e[t]||null,delete e[t]),o}function Controller(){require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="Setting",this.args=arguments[0]||{},arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var e=this,t={};e.__views.winSetting=Ti.UI.createWindow({backgroundColor:Alloy.Globals.ThemeStyles.win.backgroundColor,barColor:Alloy.Globals.ThemeStyles.win.barColor,navTintColor:Alloy.Globals.ThemeStyles.win.navTintColor,layout:"vertical",translucent:!1,id:"winSetting",title:"Settings"}),e.__views.winSetting&&e.addTopLevelView(e.__views.winSetting),t.destroy=function(){},_.extend(e,e.__views),arguments[0]||{},e.winSetting.addEventListener("open",function(){var t="/images/PhotoponNavBarBtnInfo.png";UTL.userInfo().photo&&(t=UTL.userInfo().photo.urls.square_75);var o=Ti.UI.createImageView({image:t,width:100,height:100,top:10}),l=PUI.createPhotoponButtonSmall("Choose Photo");l.right=Alloy.Globals.ThemeStyles.button.padding,l.left=Alloy.Globals.ThemeStyles.button.padding,l.addEventListener("click",function(){UTL.UploadPhoto(function(e){o.setImage(e.urls.square_75),API.UpdateProfilePhoto(e.id)})});var i=PUI.createPhotoponButtonSmall("Become Merchant");i.right=Alloy.Globals.ThemeStyles.button.padding,i.left=Alloy.Globals.ThemeStyles.button.padding,i.addEventListener("click",function(){Dialogs.confirm({title:"Confirm",message:"Do you want to become Mercahnt?",callback:function(){API.AskToBecomeMerchant(function(){alert("Request was sent to administrators!")})}})});var r=PUI.createPhotoponInputSmall("Old Password"),n=PUI.createPhotoponInputSmall("New Password");r.passwordMask=!0,n.passwordMask=!0;var a=PUI.createPhotoponButtonSmall("Change Password");a.right=Alloy.Globals.ThemeStyles.button.padding,a.left=Alloy.Globals.ThemeStyles.button.padding,a.addEventListener("click",function(){return UTL.userInfo().password!=r.value?(r.value="",void alert("Wrong password")):void API.ChangePassword(n.value,function(){alert("Password changed!")})}),e.winSetting.add(o),e.winSetting.add(l),e.winSetting.add(r),e.winSetting.add(n),e.winSetting.add(a);var s=UTL.userInfo().role;"merchant"!=s&&e.winSetting.add(i)}),_.extend(e,t)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;