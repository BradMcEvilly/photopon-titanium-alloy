function ucfirst(e){return e?e[0].toUpperCase()+e.substr(1):e}function addNamespace(e){return(CONST.IMPLICIT_NAMESPACES[e]||CONST.NAMESPACE_DEFAULT)+"."+e}function processStyle(e,l,o,t,r){t=t||{},t.classes=o,l.apiName&&(t.apiName=l.apiName),l.id&&(t.id=l.id),l.applyProperties(exports.createStyle(e,t,r))}function isTabletFallback(){return Math.min(Ti.Platform.displayCaps.platformHeight,Ti.Platform.displayCaps.platformWidth)>=700}function deepExtend(){var e,l,o,t,r,i,n=arguments[0]||{},a=1,s=arguments.length,d=!1;for("boolean"==typeof n&&(d=n,n=arguments[1]||{},a=2),"object"==typeof n||_.isFunction(n)||(n={});s>a;a++)if(e=arguments[a],null!=e){"string"==typeof e&&(e=e.split(""));for(l in e)o=n[l],t=e[l],n!==t&&(d&&t&&_.isObject(t)&&((r=_.isArray(t))||!_.has(t,"apiName"))&&(r?(r=!1,i=o&&_.isArray(o)?o:[]):i=_.isDate(t)?new Date(t.valueOf()):o&&_.isObject(o)?o:{},n[l]=deepExtend(d,i,t)),n[l]=t)}return n}var _=require("alloy/underscore")._,Backbone=require("alloy/backbone"),CONST=require("alloy/constants");exports.version="1.6.0",exports._=_,exports.Backbone=Backbone;var DEFAULT_WIDGET="widget",TI_VERSION=Ti.version,MW320_CHECK=!1,IDENTITY_TRANSFORM=void 0,RESET={bottom:null,left:null,right:null,top:null,height:null,width:null,shadowColor:null,shadowOffset:null,backgroundImage:null,backgroundRepeat:null,center:null,layout:null,backgroundSelectedColor:null,backgroundSelectedImage:null,opacity:1,touchEnabled:!0,enabled:!0,horizontalWrap:!0,zIndex:0,backgroundColor:null,font:null,visible:!0,color:null,transform:null,backgroundGradient:{},borderColor:"transparent",borderRadius:0,borderWidth:0};RESET=_.extend(RESET,{backgroundLeftCap:0,backgroundTopCap:0}),exports.M=function(e,l,o){var t,r=(l||{}).config||{},i=r.adapter||{},n={},a={};i.type?(t=require("alloy/sync/"+i.type),n.sync=function(e,l,o){return t.sync(e,l,o)}):n.sync=function(e,l){Ti.API.warn("Execution of "+e+"#sync() function on a model that does not support persistence"),Ti.API.warn("model: "+JSON.stringify(l.toJSON()))},n.defaults=r.defaults,o&&(a.migrations=o),t&&_.isFunction(t.beforeModelCreate)&&(r=t.beforeModelCreate(r,e)||r);var s=Backbone.Model.extend(n,a);return s.prototype.config=r,_.isFunction(l.extendModel)&&(s=l.extendModel(s)||s),t&&_.isFunction(t.afterModelCreate)&&t.afterModelCreate(s,e),s},exports.C=function(e,l,o){var t,r={model:o},i=(o?o.prototype.config:{})||{};i.adapter&&i.adapter.type?(t=require("alloy/sync/"+i.adapter.type),r.sync=function(e,l,o){return t.sync(e,l,o)}):r.sync=function(e,l){Ti.API.warn("Execution of "+e+"#sync() function on a collection that does not support persistence"),Ti.API.warn("model: "+JSON.stringify(l.toJSON()))};var n=Backbone.Collection.extend(r);return n.prototype.config=i,_.isFunction(l.extendCollection)&&(n=l.extendCollection(n)||n),t&&_.isFunction(t.afterCollectionCreate)&&t.afterCollectionCreate(n),n},exports.UI={},exports.UI.create=function(controller,apiName,opts){opts=opts||{};var baseName,ns,parts=apiName.split(".");if(1===parts.length)baseName=apiName,ns=opts.ns||CONST.IMPLICIT_NAMESPACES[baseName]||CONST.NAMESPACE_DEFAULT;else{if(!(parts.length>1))throw"Alloy.UI.create() failed: No API name was given in the second parameter";baseName=parts[parts.length-1],ns=parts.slice(0,parts.length-1).join(".")}opts.apiName=ns+"."+baseName,baseName=baseName[0].toUpperCase()+baseName.substr(1);var style=exports.createStyle(controller,opts);return eval(ns)["create"+baseName](style)},exports.createStyle=function(e,l,o){var t,r;if(!l)return{};t=_.isArray(l.classes)?l.classes.slice(0):_.isString(l.classes)?l.classes.split(/\s+/):[],r=l.apiName,r&&-1===r.indexOf(".")&&(r=addNamespace(r));var i;i=require(e&&_.isObject(e)?"alloy/widgets/"+e.widgetId+"/styles/"+e.name:"alloy/styles/"+e);var n,a,s={};for(n=0,a=i.length;a>n;n++){var d=i[n],y=d.key;if(d.isApi&&-1===y.indexOf(".")&&(y=(CONST.IMPLICIT_NAMESPACES[y]||CONST.NAMESPACE_DEFAULT)+"."+y),d.isId&&l.id&&d.key===l.id||d.isClass&&_.contains(t,d.key));else{if(!d.isApi)continue;if(-1===d.key.indexOf(".")&&(d.key=addNamespace(d.key)),d.key!==r)continue}d.queries&&d.queries.formFactor&&!Alloy[d.queries.formFactor]||deepExtend(!0,s,d.style)}var b=_.omit(l,[CONST.CLASS_PROPERTY,CONST.APINAME_PROPERTY]);return deepExtend(!0,s,b),s[CONST.CLASS_PROPERTY]=t,s[CONST.APINAME_PROPERTY]=r,MW320_CHECK&&delete s[CONST.APINAME_PROPERTY],o?_.defaults(s,o):s},exports.addClass=function(e,l,o,t){if(!o)return void(t&&(MW320_CHECK&&delete t.apiName,l.applyProperties(t)));var r=l[CONST.CLASS_PROPERTY]||[],i=r.length;o=_.isString(o)?o.split(/\s+/):o;var n=_.union(r,o||[]);return i===n.length?void(t&&(MW320_CHECK&&delete t.apiName,l.applyProperties(t))):void processStyle(e,l,n,t)},exports.removeClass=function(e,l,o,t){o=o||[];var r=l[CONST.CLASS_PROPERTY]||[],i=r.length;if(!i||!o.length)return void(t&&(MW320_CHECK&&delete t.apiName,l.applyProperties(t)));o=_.isString(o)?o.split(/\s+/):o;var n=_.difference(r,o);return i===n.length?void(t&&(MW320_CHECK&&delete t.apiName,l.applyProperties(t))):void processStyle(e,l,n,t,RESET)},exports.resetClass=function(e,l,o,t){o=o||[],o=_.isString(o)?o.split(/\s+/):o,processStyle(e,l,o,t,RESET)},exports.createWidget=function(e,l,o){return"undefined"!=typeof l&&null!==l&&_.isObject(l)&&!_.isString(l)&&(o=l,l=DEFAULT_WIDGET),new(require("alloy/widgets/"+e+"/controllers/"+(l||DEFAULT_WIDGET)))(o)},exports.createController=function(e,l){return new(require("alloy/controllers/"+e))(l)},exports.createModel=function(e,l){return new(require("alloy/models/"+ucfirst(e)).Model)(l)},exports.createCollection=function(e,l){return new(require("alloy/models/"+ucfirst(e)).Collection)(l)},exports.isTablet=function(){return"ipad"===Ti.Platform.osname}(),exports.isHandheld=!exports.isTablet,exports.Globals={},exports.Models={},exports.Models.instance=function(e){return exports.Models[e]||(exports.Models[e]=exports.createModel(e))},exports.Collections={},exports.Collections.instance=function(e){return exports.Collections[e]||(exports.Collections[e]=exports.createCollection(e))},exports.CFG=require("alloy/CFG");