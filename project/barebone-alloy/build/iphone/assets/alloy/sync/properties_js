function S4(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function guid(){return S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4()}function Sync(e,l,o){var t=l.config.adapter.collection_name?l.config.adapter.collection_name:"default",r=new RegExp("^("+t+")\\-(.+)$"),i=null;if("read"===e)if(l instanceof Backbone.Collection){var a=[];_.each(TAP.listProperties(),function(e){var l=e.match(r);null!==l&&a.push(TAP.getObject(e))}),i=a}else{var s=TAP.getObject(t+"-"+l.id);l.set(s),i=l.toJSON()}else"create"===e||"update"===e?(l.id||(l.id=guid(),l.set(l.idAttribute,l.id)),TAP.setObject(t+"-"+l.id,l.toJSON()||{}),i=l.toJSON()):"delete"===e&&(TAP.removeProperty(t+"-"+l.id),l.clear(),i=l.toJSON());i?(_.isFunction(o.success)&&o.success(i),"read"===e&&l.trigger("fetch")):_.isFunction(o.error)&&o.error(i)}var Alloy=require("alloy"),_=require("alloy/underscore")._,TAP=Ti.App.Properties;module.exports.sync=Sync,module.exports.beforeModelCreate=function(e){return e=e||{},e.columns=e.columns||{},e.defaults=e.defaults||{},("undefined"==typeof e.columns.id||null===e.columns.id)&&(e.columns.id="String"),e};