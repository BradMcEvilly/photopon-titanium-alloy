function __processArg(e,t){var o=null;return e&&(o=e[t]||null,delete e[t]),o}function Controller(){require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="Uploader",this.args=arguments[0]||{},arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var e=this,t={};e.__views.winUploader=Ti.UI.createWindow({id:"winUploader",title:"Upload Photo",backgroundColor:"#ececec"}),e.__views.winUploader&&e.addTopLevelView(e.__views.winUploader),t.destroy=function(){},_.extend(e,e.__views);var o=arguments[0]||{},l=function(t){Cloud.Photos.create({photo:t},function(t){if(console.log(t),t.success){var l=t.photos[0];o.callback&&(o.callback(l),e.winUploader.close())}else alert("Error:\n"+(t.error&&t.message||JSON.stringify(t)))})};e.winUploader.addEventListener("open",function(){UTL.defaultTitle(o);var t=PUI.createPhotoponButton("Choose Photo");t.right=Alloy.Globals.ThemeStyles.button.padding,t.left=Alloy.Globals.ThemeStyles.button.padding,t.addEventListener("click",function(){Titanium.Media.openPhotoGallery({success:function(e){Ti.API.debug("Our type was: "+e.mediaType),e.mediaType==Ti.Media.MEDIA_TYPE_PHOTO&&l(e.media)},cancel:function(){},error:function(e){Ti.API.error(e)},mediaTypes:[Ti.Media.MEDIA_TYPE_PHOTO]})}),e.winUploader.add(t)}),_.extend(e,t)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;