function __processArg(e,t){var o=null;return e&&(o=e[t]||null,delete e[t]),o}function Controller(){require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="AddLocation",this.args=arguments[0]||{},arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var e=this,t={};e.__views.winAddLocation=Ti.UI.createWindow({backgroundColor:Alloy.Globals.ThemeStyles.win.backgroundColor,title:"Add Location",titleAttributes:Alloy.Globals.ThemeStyles.win.titleAttributes,navTintColor:Alloy.Globals.ThemeStyles.win.navTintColor,barColor:Alloy.Globals.ThemeStyles.win.barColor,translucent:Alloy.Globals.ThemeStyles.win.translucent,id:"winAddLocation"}),e.__views.winAddLocation&&e.addTopLevelView(e.__views.winAddLocation),t.destroy=function(){},_.extend(e,e.__views),arguments[0]||{};var o=PUI.DecorateWindow(e.winAddLocation);PUI.Awesomize(o);var l=PUI.CreateTable(o);PUI.CreateRow(l);var i=PUI.CreateRow(l),r=PUI.CreateRow(l),n=PUI.CreateRow(l),a=PUI.CreateRow(l),s=PUI.CreateRow(l),d=PUI.CreateRow(l);i.height=60,r.height=60,n.height=80,a.height=66,s.height=66,d.height=66;var u=PUI.CreateInput(i,"Enter Name"),h=PUI.CreateInput(r,"Enter Address"),c=Titanium.UI.createImageView({image:"/images/PhotoponNavBarBtnInfo.png",width:60,height:60});c.addEventListener("click",function(){UTL.UploadPhoto(function(e){o.photo=e.id,c.image=e.urls.square_75})}),n.add(c);var p=function(e){var t=Titanium.UI.createWindow();PUI.DecorateWindow(t),t.title="Choose Address";var l=PUI.CreateTable(t);l.top=20;for(var i=0;i<Math.min(10,e.length);++i){var r=PUI.CreateRow(l);r.height=60;var n=PUI.CreateLabel(r,e[i].formatted_address);n.wordWrap=!0,n.color="#000000",r.locationData=e[i],r.addEventListener("click",function(e){var l=e.row.locationData;l.geometry&&l.geometry.location&&(o.location=l.geometry.location,h.value=e.row.locationData.formatted_address,t.close())})}Alloy.Globals.navGroup.openWindow(t,{animated:!0})};PUI.CreateButton(a,"Check address",function(){var e=PUI.ShowLoading("Searching address...");UTL.GetLocation(h.value,function(t){if(e.close(),console.log(t),0==t.results.length)return void alert("Address not found.");if(1==t.results.length){var l=t.results[0];return void(l.geometry&&l.geometry.location?o.location=l.geometry.location:alert("Can not resolve location"))}p(t.results);for(var i=0;i<t.results.length;++i)console.log(t.results[i].formatted_address)})}),PUI.CreateButton(s,"Show Map",function(){UTL.ShowPage("PickLocation",{callback:function(e){h.value="@"+e.lat+","+e.lng,o.location=e}})}),PUI.CreateButton(d,"Add Location",function(){console.log(u.value),console.log(h.value),console.log(o.location),console.log(o.photo),API.NewLocation({name:u.value,address:h.value,photo_id:o.photo,latitude:o.location.lat,longitude:o.location.lng},function(){alert("Location added!"),o.close()},alert)}),_.extend(e,t)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;